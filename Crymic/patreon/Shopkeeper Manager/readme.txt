This macro will let you get a listing of all items on the shopkeeper, then you can update Money, Quantity, Prices and Rarity.

Updates

1/20/21: Can now update all Uncommon, Rare, Very Rare and Legendary Prices based on DMG or XGtE when choosing auto.
6/18/21: Update for 8.x