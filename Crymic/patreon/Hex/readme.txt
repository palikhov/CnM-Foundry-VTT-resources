Here is Hex, it's went through a lot of changes.. Luckily in 8.x now when adding disadvantage to a core stat, it makes all related skills roll with disadvantage as well. I had written out a whole function for this, but not needed anymore! However, there is one issue with this macro, the health monitor is not there. I will likely come back at a later point and add it in.

You place a curse on a creature that you can see within range. Until the spell ends, you deal an extra 1d6 necrotic damage to the target whenever you hit it with an attack. Also, choose one ability when you cast the spell. The target has disadvantage on ability checks made with the chosen ability.
If the target drops to 0 hit points before this spell ends, you can use a bonus action on a subsequent turn of yours to curse a new creature.
At Higher Levels. When you cast this spell using a spell slot of 3rd or 4th level, you can maintain your concentration on the spell for up to 8 hours. When you use a spell slot of 5th level or higher, you can maintain your concentration on the spell for up to 24 hours.

Required Modules
Advanced Macros
Midi-qol
DAE
Item Macro (optional)

Updates
8/1/21 - ActiveEffect gm execute macro no longer needed with new functions from latest Midi-qol